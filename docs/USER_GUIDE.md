# Modern Excel PMS 利用者ガイド

Excel で Jira や Asana のような操作性を実現するプロジェクト管理システムの使い方を説明します。

---

## 目次

1. [はじめに](#1-はじめに)
2. [ファイルを開く](#2-ファイルを開く)
3. [シート構成](#3-シート構成)
4. [基本的な使い方](#4-基本的な使い方)
5. [WBS（タスク管理）の操作](#5-wbsタスク管理の操作)
6. [ガントチャートの見方](#6-ガントチャートの見方)
7. [カンバンボードの使い方](#7-カンバンボードの使い方)
8. [案件・施策の管理](#8-案件施策の管理)
9. [設定のカスタマイズ](#9-設定のカスタマイズ)
10. [よくある質問](#10-よくある質問)

---

## 1. はじめに

### このツールでできること

- **タスク管理**: WBS形式でタスクを階層管理
- **自動ガントチャート**: 開始日と工数から自動でガント表示
- **進捗の自動計算**: 工数加重平均による正確な進捗率
- **ステータス自動判定**: 期限と進捗から「遅延」を自動検出
- **カンバンボード**: To Do / Doing / Done でタスクを可視化

### 対応環境

- Microsoft 365 Excel（推奨）
- Excel 2019 以降（一部機能制限あり）

### ファイルの種類

| ファイル | 対象環境 | 特徴 |
|---------|---------|------|
| `ModernExcelPMS.xlsx` | Excel 2019以降 | 互換性重視、件数表示 |
| `ModernExcelPMS_M365.xlsx` | Microsoft 365 / SharePoint | FILTER/LET使用、詳細表示 |
| `ModernExcelPMS_with_vba.xlsm` | デスクトップ Excel のみ | VBAマクロ付き |

**SharePoint で共有する場合は `ModernExcelPMS_M365.xlsx` を使用してください。**

---

## 2. ファイルを開く

### 通常版（.xlsx）

1. `ModernExcelPMS.xlsx` をダブルクリック
2. そのまま利用開始

### VBA付き版（.xlsm）

1. `ModernExcelPMS_with_vba.xlsm` をダブルクリック
2. セキュリティ警告が表示されたら「コンテンツの有効化」をクリック
3. マクロが有効になり、ボタン操作が利用可能に

---

## 3. シート構成

| シート名 | 役割 | 主な操作 |
|---------|------|---------|
| **Config** | 設定 | 祝日・担当者・ステータスを編集 |
| **Template** | WBSひな形 | コピー元（編集しない） |
| **PRJ_001** | WBS（プロジェクト1） | タスクの入力・管理 |
| **PRJ_002** | WBS（プロジェクト2） | タスクの入力・管理 |
| **Case_Master** | 案件一覧 | 顧客・案件の管理 |
| **Measure_Master** | 施策一覧 | 施策とWBSの紐付け |
| **Kanban_View** | カンバンボード | タスク状況の可視化 |

---

## 4. 基本的な使い方

### 入力可能なセル

薄青色（水色）のセルが入力可能です。

![入力セル](../output/screenshots/03_PRJ_001.png)

### 自動計算されるセル

グレー背景のセルは自動計算されます。手動で編集しないでください。

- **終了日**: 開始日 + 工数 - 1（祝日除外）
- **ステータス**: 進捗率と期限から自動判定
- **全体進捗**: 工数加重平均

---

## 5. WBS（タスク管理）の操作

### タスクを追加する

1. `PRJ_001` シートを開く
2. 5行目以降の空行にタスク情報を入力:

| 列 | 項目 | 入力例 |
|----|------|--------|
| A | Lv（階層） | 1 または 2 |
| B | タスク名 | 要件定義書作成 |
| C | 担当 | プルダウンから選択 |
| D | 開始日 | 2024/05/01 |
| E | 工数(日) | 5 |
| G | 進捗率 | 0.5（50%の場合） |
| I | 備考 | メモなど |

### 階層（Lv）の使い方

- **Lv1**: フェーズ・マイルストーン（例: 設計フェーズ）
- **Lv2**: 個別タスク（例: 画面設計書作成）

```
Lv1: 設計フェーズ
  └ Lv2: 画面設計書作成
  └ Lv2: DB設計書作成
  └ Lv2: API設計書作成
Lv1: 開発フェーズ
  └ Lv2: フロントエンド開発
  └ Lv2: バックエンド開発
```

### 進捗率の入力

- 0〜1 の小数で入力（0.5 = 50%）
- セルは自動的にパーセント表示されます

### ステータスの自動判定ルール

| 条件 | ステータス |
|------|-----------|
| 進捗率 = 100% | 完了 |
| 終了日 < 今日 かつ 未完了 | 遅延 |
| 開始日 <= 今日 かつ 未完了 | 進行中 |
| それ以外 | 未着手 |

---

## 6. ガントチャートの見方

### 色の意味

| 色 | 意味 |
|----|------|
| 青 | 進行中・未着手 |
| 赤 | 遅延 |
| グレー | 完了 |
| 赤い縦線 | 今日 |

### ガント開始日の変更

1. K2セル（「ガント開始日」の隣）をクリック
2. 表示開始日を入力（例: 2024/05/01）
3. ガントチャートの表示範囲が変わります

---

## 7. カンバンボードの使い方

### WBSシートを選択

1. `Kanban_View` シートを開く
2. B2セルのプルダウンから対象WBSを選択（例: PRJ_001）
3. 各列にタスク件数が表示されます

### 列の意味

| 列 | ステータス |
|----|-----------|
| To Do | 未着手 |
| Doing | 進行中 |
| Done | 完了 |

### VBA版の追加機能

VBA付き版（.xlsm）では、カードをダブルクリックするとステータスが更新されます:
- To Do → Doing → Done の順に遷移

### M365版の詳細カード表示

M365版（`ModernExcelPMS_M365.xlsx`）では、FILTER/LET関数を使用して各タスクの詳細がスピル表示されます:

```
タスク名
担当者 / 期限(m/d)
```

例:
```
要件定義書作成
PM_佐藤 / 5/15

画面設計書作成
TL_田中 / 5/20
```

**メリット:**
- 一目でタスクの詳細がわかる
- SharePoint / Excel Online で動作
- VBAなしで動的更新

---

## 8. 案件・施策の管理

### Case_Master（案件管理）

顧客や案件単位で管理します。

| 列 | 項目 | 説明 |
|----|------|------|
| A | 案件ID | 一意のID（例: CASE-001） |
| B | 案件名 | 顧客名やプロジェクト名 |
| C | メモ | 自由記述 |
| D | 施策数 | 自動計算 |
| E | 平均進捗 | 自動計算 |

### Measure_Master（施策管理）

案件に紐づく施策（プロジェクト）を管理します。

| 列 | 項目 | 説明 |
|----|------|------|
| A | 施策ID | 一意のID（例: ME-001） |
| B | 親案件ID | Case_Masterの案件ID |
| C | 施策名 | 施策の名前 |
| D | 開始日 | 施策の開始日 |
| E | WBSリンク | 自動生成（クリックでWBSへ） |
| F | WBSシート名 | 紐付けるWBSシート名 |
| G | 実進捗 | WBSから自動取得 |
| H | 備考 | 自由記述 |

### WBSとの連携手順

1. `Measure_Master` のF列に WBSシート名を入力（例: PRJ_001）
2. E列に「WBSを開く」リンクが自動生成
3. G列にWBSの全体進捗が自動反映

---

## 9. 設定のカスタマイズ

### 祝日の追加

1. `Config` シートを開く
2. B列（祝日リスト）に日付を追加
3. WBSの終了日計算に自動反映

### 担当者の追加

1. `Config` シートを開く
2. D列（担当者リスト）に名前を追加
3. WBSの担当者プルダウンに自動反映

### ステータスの変更

1. `Config` シートを開く
2. F列（ステータスリスト）を編集
3. ※ 自動判定ロジックは変わりません

---

## 10. よくある質問

### Q: 新しいWBSシートを作成したい

**A**: VBA版の場合、Templateシートの「複製」ボタンをクリックすると `PRJ_003` のように自動採番されます。通常版の場合は、Templateシートを右クリック→「移動またはコピー」で複製してください。

### Q: タスクの順番を入れ替えたい

**A**: VBA版の場合、タスク行を選択して「▲ Up」「▼ Down」ボタンで移動できます。通常版の場合は、行を切り取り→挿入で対応してください。

### Q: 終了日が計算されない

**A**: 以下を確認してください:
- 開始日が正しい日付形式か
- 工数が1以上の整数か
- Configシートの祝日リストに問題がないか

### Q: ステータスが「遅延」にならない

**A**: 終了日が今日より前で、かつ進捗率が100%未満の場合のみ「遅延」になります。開始日と工数を確認してください。

### Q: 保護されていて編集できない

**A**: 薄青色のセルのみ編集可能です。グレーのセル（計算セル）は保護されています。全体の保護を解除するには、「校閲」タブ→「シート保護の解除」でパスワード `pms-2024` を入力してください。

### Q: マクロが動かない

**A**: 以下を確認してください:
1. ファイル拡張子が `.xlsm` か
2. 「コンテンツの有効化」をクリックしたか
3. セキュリティ設定でマクロが許可されているか

### Q: 動作が遅い

**A**: PRJシートが30枚を超えると再計算に時間がかかります。以下を試してください:
1. 「数式」タブ→「計算方法の設定」→「手動」に変更
2. 必要なときだけ F9 キーで再計算
3. 案件ごとにブックを分割

---

## サポート

問題が解決しない場合は、開発ドキュメントを参照してください:

- [VBAセットアップガイド](VBA_SETUP_GUIDE.md)
- [シート保護設計](sheet_protection_plan.md)
- [パフォーマンス計測](recalc_performance_report.md)

---

*このガイドは Modern Excel PMS v1.0 向けに作成されました。*
