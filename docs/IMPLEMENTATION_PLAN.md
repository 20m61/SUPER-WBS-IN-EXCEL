# 実装計画

本リポジトリの仕様を基に、実際に利用できるブックを組み立てるための作業計画をまとめます。フェーズを細分化し、今回のコミットで着手する範囲を明確にしています。

## フェーズ分割
1. **Phase 1: コアレイアウト構築**
   - `Config` / `Template` / `PRJ_001` / `Case_Master` / `Measure_Master` / `Kanban_View` を生成し、主要なセル・数式・データ検証を整備する。
   - 手動操作なしで再生成できるよう、Python スクリプトでブックを構築する。
2. **Phase 2: UI 表現強化**
   - 条件付き書式、色やフォント、ウィンドウ枠固定など見た目の要素を強化する。
   - ガント用の条件付き書式とカンバン向けのセルスタイルを追加する。
3. **Phase 3: VBA 自動化**
   - 行入れ替え、`Template` 複製、新規施策作成、ダブルクリックでのステータス更新を VBA で実装する。
   - セキュリティ設定（マクロ有効ブック化、シート保護範囲）を決定する。

## 今回の実装範囲（Phase 1）
- Python で `ModernExcelPMS.xlsx` を自動生成するスクリプトを `tools/build_workbook.py` として追加。
- 下記のセル/数式を含む雛形を出力。
  - `Config`: 祝日・担当者のサンプルと、データ検証用の候補リスト。
  - `Template` / `PRJ_001`: Lv/タスク/担当/開始日/工数/終了日/進捗率/ステータス列と、`WORKDAY`・`IFS`・`AVERAGE(FILTER())` による進捗算出。
  - `Case_Master`: 案件ごとの施策数 `COUNTIF`、平均進捗 `AVERAGEIF`。
  - `Measure_Master`: `HYPERLINK` による WBS へのジャンプ、`INDIRECT` で進捗を吸い上げ。
  - `Kanban_View`: `B2` のデータ検証で WBS シート名を選択し、`FILTER`/`LET`/`MAP` で ToDo/Doing/Done のカード文字列を生成。

## 次に着手すべきタスク
- 条件付き書式でガント・ステータス色を付与する（Phase 2）。
- VBA で行入れ替えとダブルクリック更新を実装し、`.xlsm` 出力に切り替える（Phase 3）。
- `Case_Master` のドリルダウン用スピル表示領域を追加し、参照先範囲とシート保護を確定する。
