# 実装計画

本リポジトリの仕様を基に、実際に利用できるブックを組み立てるための作業計画をまとめます。フェーズを細分化し、着手状況を明確にしています。

## フェーズ分割
1. **Phase 1: コアレイアウト構築（完了）**
   - `Config` / `Template` / `PRJ_001` / `Case_Master` / `Measure_Master` / `Kanban_View` を生成し、主要なセル・数式・データ検証を整備する。
   - 手動操作なしで再生成できるよう、Python スクリプトでブックを構築する。
2. **Phase 2: UI 表現強化（完了）**
   - 条件付き書式、色やフォント、ウィンドウ枠固定など見た目の要素を強化する。
   - ガント用の条件付き書式とカンバン向けのセルスタイルを追加する。
3. **Phase 3: VBA 自動化（完了）**
   - 行入れ替え、`Template` 複製、新規施策作成、ダブルクリックでのステータス更新を VBA で実装する。
   - セキュリティ設定（マクロ有効ブック化、シート保護範囲）を決定する。

## 実装済みの成果物
- Python で `ModernExcelPMS.xlsm` を自動生成するスクリプトを `tools/build_workbook.py` として整備。
- 雛形ブックには以下を含む。
  - `Config`: 祝日・担当者サンプルとデータ検証用リスト。
  - `Template` / `PRJ_001`: Lv/タスク/担当/開始日/工数/終了日/進捗率/ステータス列と、`WORKDAY`・`IFS`・工数加重平均による全体進捗計算。ガント/ステータスの条件付き書式も適用済み。
  - `Case_Master`: 施策数 `COUNTIF`、平均進捗 `AVERAGEIF`、案件ドリルダウンの `FILTER` スピル領域。
  - `Measure_Master`: `HYPERLINK` での WBS ジャンプ、`INDIRECT` を介した進捗吸い上げ（参照切れ時は「未リンク」）。
  - `Kanban_View`: `B2` のデータ検証で WBS シート名を選択し、`FILTER`/`LET`/`MAP` を `IFERROR` でガードしたカード表示。ダブルクリックでステータスを書き換える VBA と連携。
  - **VBA モジュール**: 行入れ替え・テンプレート複製・ステータス更新・シート名採番・手動再計算ユーティリティを `docs/vba` から取り込み、`.xlsm` に同梱。

## 現時点のステータス
- 予定していたフェーズはすべて完了し、追加の必須タスクはありません。
- パフォーマンスや保護設定の詳細な運用手順は `docs/recalc_performance_report.md` と `docs/sheet_protection_plan.md` にまとめています。
